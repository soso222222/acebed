<!DOCTYPE html>
<html lang="ko">
  <head>
    <?php include '../include/head.html'; ?>
    <title>매트리스 | 침대 | ACE BED</title>
    <meta name="description" content="ACE BED 매트리스 상품 안내" />
  </head>
  <body class="sub bed bed-mattress">
    <div id="wrapper">
      <?php include '../include/header.html'; ?>

      <main id="main">
        <div class="sub-header">
          <div class="background-matt">
            <h2>매트리스</h2>
          </div>
        </div>
      
      
        <section id="sub-product-list">
        
          <h3 class="ir-hidden">매트리스 리스트</h3>
          <div class="product">
            <div class="content-box">
        
              <div class="top">
                <p class="total-product">총 <strong class="num">20개</strong>의 제품이 있습니다.</p>
                <div class="filter">
                  <span class="clear">검색 초기화</span>
                  <ul class="keyword">
                  </ul>
                </div>
                <ul class="arr-list">
                  <li class="view">
                    <ul>
                      <li class="row-3 on"><a href="#">3열 보기</a></li>
                      <li class="row-2"><a href="#">2열 보기</a></li>
                    </ul>
                  </li>
                  <li class="order">
                    <select class="arr" title="sort">
                      <option value="rec">추천순</option>
                      <option value="hot">인기순</option>
                    </select>
                  </li>
                </ul>
              </div>
              <div class="top-m">
                <div class="box">
                  <span>검색필터</span>
                  <ul class="arr-list">
                    <li class="row-2 on"><a href="#">2열 보기</a></li>
                    <li class="row-1"><a href="#">1열 보기</a></li>
                  </ul>
                </div>
                <div class="filter">
                  <span class="clear">초기화</span>
                  <ul class="keyword">
                  </ul>
                </div>
                <p class="total-product">총 <strong class="num">20개</strong> 제품</p>
                <div class="order">
                  <select class="arr" title="sort">
                    <option value="rec">추천순</option>
                    <option value="hot">인기순</option>
                  </select>
                </div>
              </div>
        
            </div>
            <div class="bottom">
              <div class="side">
                <div class="search-box">
                  <p>
                    <input type="text" id="search-keyword" name="" placeholder="검색어를 입력하세요" />
                    <label for="search-keyword"><a href="#"><i class="fas fa-search"><span>검색</span></i></a></label>
                  </p>
                  <div class="keyword">
                    <div class="recent-word">
                      <p class="title"><em>최근 검색어</em></p>
                      <p>최근 검색어가 존재하지 않습니다.</p>
                    </div>
                    <div class="recommend-word">
                      <p class="title"><em>추천 검색어</em></p>
                      <ul>
                        <li><a href="#">1. ZANA</a></li>
                        <li><a href="#">2. IRINA</a></li>
                        <li><a href="#">3. HYBRID TECH</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
        
                <div class="category-matt">
                  <ul>
                    <li data-menu="size">
                      <a href="#">
                        <em>사이즈</em>
                        <img alt="분류 열기" src="../img/side-icon-on.png" class="open" />
                        <img alt="분류 닫기" src="../img/side-icon-off.png" class="close" />
                      </a>
                      <ul>
                        <li>
                          <input type="checkbox" id="category-size-lk" name="category-size" value="lk" />
                          <label for="category-size-lk">라이킹(LK)</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-size-k" name="category-size" value="k" />
                          <label for="category-size-k">킹(K)</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-size-lq" name="category-size" value="lq" />
                          <label for="category-size-lq">라지퀸(LQ)</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-size-dd" name="category-size" value="dd" />
                          <label for="category-size-dd">더블(DD)</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-size-ss" name="category-size" value="ss" />
                          <label for="category-size-ss">슈퍼싱글(SS)</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-size-ds" name="category-size" value="ds" />
                          <label for="category-size-ds">디럭스싱글(DS)</label>
                        </li>
                      </ul>
                    </li>
                    <li data-menu="rank">
                      <a href="#">
                        <em>매트리스 등급</em>
                        <img alt="분류 열기" src="../img/side-icon-on.png" class="open" />
                        <img alt="분류 닫기" src="../img/side-icon-off.png" class="close" />
                      </a>
                      <ul>
                        <li>
                          <input type="checkbox" id="category-rank-royal" name="category-rank" value="royal-ace" />
                          <label for="category-rank-royal">ROYAL ACE</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-rank-hybrid" name="category-rank" value="hybrid-tech" />
                          <label for="category-rank-hybrid">HYBRID TECH</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-rank-ace" name="category-rank" value="ace" />
                          <label for="category-rank-ace">ACE</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-rank-etc" name="category-rank" value="etc" />
                          <label for="category-rank-etc">기타</label>
                        </li>
                      </ul>
                    </li>
                    <li data-menu="cushion">
                      <a href="#">
                        <em>쿠션감</em>
                        <img alt="분류 열기" src="../img/side-icon-on.png" class="open" />
                        <img alt="분류 닫기" src="../img/side-icon-off.png" class="close" />
                      </a>
                      <ul>
                        <li>
                          <input type="checkbox" id="category-cushion-premium-soft" name="category-cushion" value="premium-soft" />
                          <label for="category-cushion-premium-soft">Premium Soft</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-cushion-soft" name="category-cushion" value="soft" />
                          <label for="category-cushion-soft">Soft</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-cushion-reg" name="category-cushion" value="regular" />
                          <label for="category-cushion-reg">Regular</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-cushion-hard" name="category-cushion" value="hard" />
                          <label for="category-cushion-hard">Hard</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-cushion-super-hard" name="category-cushion" value="super-hard" />
                          <label for="category-cushion-super-hard">Super Hard</label>
                        </li>
                        </ul>
                        </li>
                    <li data-menu="spring">
                      <a href="#">
                        <em>적용 스프링</em>
                        <img alt="분류 열기" src="../img/side-icon-on.png" class="open" />
                        <img alt="분류 닫기" src="../img/side-icon-off.png" class="close" />
                      </a>
                      <ul>
                        <li>
                          <input type="checkbox" id="category-spring-hybrid-z" name="category-spring" value="hybrid-z" />
                          <label for="category-spring-hybrid-z">Hybrid Z Spring</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-spring-hybrid-h" name="category-spring" value="hybrid-h" />
                          <label for="category-spring-hybrid-h">Hybrid H Spring</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-spring-hybrid-s" name="category-spring" value="hybrid-s" />
                          <label for="category-spring-hybrid-s">Hybrid S Spring</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-spring-hybrid" name="category-spring" value="hybrid" />
                          <label for="category-spring-hybrid">Hybrid Spring</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-spring-plus-power" name="category-spring" value="plus-power" />
                          <label for="category-spring-plus-power">Plus Power Spring</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-spring-magin-power" name="category-spring" value="magin-power" />
                          <label for="category-spring-magin-power">Magic Power Spring</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-spring-super-power" name="category-spring" value="super-power" />
                          <label for="category-spring-super-power">Super Power Spring</label>
                        </li>
                      </ul>
                    </li>
                    <li data-menu="store">
                      <a href="#">
                        <em>판매처</em>
                        <img alt="분류 열기" src="../img/side-icon-on.png" class="open" />
                        <img alt="분류 닫기" src="../img/side-icon-off.png" class="close" />
                      </a>
                      <ul>
                        <li>
                          <input type="checkbox" id="category-store-dept" name="category-store" value="dept" />
                          <label for="category-store-dept">백화점</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-store-agency" name="category-store" value="agency" />
                          <label for="category-store-agency">대리점</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-store-online" name="category-store" value="online" />
                          <label for="category-store-online">온라인몰</label>
                        </li>
                        <li>
                          <input type="checkbox" id="category-store-part" name="category-store" value="part" />
                          <label for="category-store-part">일부매장</label>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
        
              <div class="list-box row-3">
                <div class="box">
                  <ul class="list">
                  </ul>
                </div>
                <div class="paging">
                  <p class="number">
                    <a href="#" class="prev_first"></a>
                    <a href="#" class="on">1</a>
                    <a href="#">2</a>
                    <a href="#" class="next-last"></a>
                  </p>
                </div>
              </div>
            </div>
        
          </div>
        
        </section>
      
      </main>

      <?php include '../include/footer.html'; ?>
    </div>

  </body>
  <script>
  'use strict';
  var bedInfoData = null;
  setLogo();
  setViewRow();
  $('#sub-product-list .top > p.total-product > strong.num').text($('#sub-product-list div.list-box > ul > li').length);
  $('#sub-product-list div.list-box').css({'opacity': '1', 'transform': 'translateY(0)'});
  loadList();
  
  $(window).on('resize', function() {
    setLogo();
    setViewRow();
  });

  $(".category-matt input[type='checkbox']").change(function () {
    var categoryId = $(this).attr('id');
    var categoryType = '';
    var keyword = '';

    if ($(this).is(":checked")) {
      categoryType = $(this).attr('name');
      keyword = $(this).attr('value');
      
      $(this).parent().addClass('on');
      addTag(categoryId, $(this).siblings('label').text());

    } else {
      //del tag
      if ($('#sub-product-list .filter > ul.keyword:eq(0) > li').length > 1) {
        categoryType = $(this).attr('name');
        keyword = $(this).attr('value');
        delTag('', categoryId);
      } else {
        $(this).parent().removeClass('on');
        delTag('all');
      }
      //
    }
    showList();
  });


  //event 위임
  $('#sub-product-list div.filter > ul.keyword').on('click', 'a.del', function (e) {
    var categoryId = $(this).parent().attr('data-category');

    if ($('#sub-product-list .filter > ul.keyword:eq(0) > li').length > 1) {
      // $('#sub-product-list div.side ul > li > ul > li > input:checked').each(function (i) {
      $(".category-matt input[type='checkbox']:checked").each(function (i) {
        if (categoryId == $(this).attr('id')) {
          delTag('', categoryId);
          $(this).prop('checked', false);
          $(this).parent().removeClass('on');
          return false;
        }
      });
    } else {
      $(this).parent().removeClass('on');
      $(".category-matt input[type='checkbox']").prop('checked', false);
      delTag('all');
    }
    showList();
  });

  $('#sub-product-list div.top > div.filter span.clear').on('click', function() {
    $(".category-matt input[type='checkbox']").prop('checked', false);
    $('#sub-product-list div.side ul > li > ul > li').removeClass('on');
    delTag('all');
    showList();
  });

  function loadList() {
    $.ajax({
      url: '../json/bed-product.json',
      dataType: 'json',

      success: function (loadData) {
        bedInfoData = loadData.bedInfo;

        if (bedInfoData.length > 0) {
          showList();
        }
      },
			error : function() {
				console.log('data load error');			
			}
    });
  }

  //showList($(this).parent().find('input').attr('name'), $(this).parent().find('input').attr('value'));
  // <input type="checkbox" id="category-rank-royal" name="category-rank" value="royal-ace" />
  // <label for="category-rank-royal">ROYAL ACE</label>
  // sholist(category-rank, royal-ace)
  function showList() {
    var total = 0;
    var dl = '';
    var resultArr = bedInfoData;
    var categoryType = '';
    var categoryValue = '';

    $('#sub-product-list div.list-box ul.list').find('li').remove();
    
    $(".category-matt input[type='checkbox']:checked").each(function (index) {
      categoryType = $(this).attr('name');
      categoryValue = $(this).attr('value');
      
      resultArr = resultArr.filter(function (el, i) {
        var data = el[categoryType].toLowerCase().split('/');
        return data.indexOf(categoryValue);
        // return el[categoryType].toLowerCase() === categoryValue;
      });
    });
    // if (category != undefined && category != '') {
    //   if (Array.isArray(category)) {
    //     resultArr = bedInfoData;
    //     // $.each(category, function(i, item){ 
    //     //   searchFilter(resultArr, key[0]);
    //     // });
    //     resultArr = resultArr.filter(function (el, i) {
    //       return el[i][category].toLowerCase() === key[i];
    //     });
    //   } else {
    //     resultArr = bedInfoData.filter(function (el, i) {
    //       return el[category].toLowerCase() === key;
    //     });
    //   }
    // } else {
    //   resultArr = bedInfoData;
    // }
    
    $.each(resultArr, function (i, item) {
      var categoryName = item['name'];
      var categorySize = item['category-size'].replaceAll('/', ' / ');
      var categoryRank = item['category-rank'].replaceAll('-', ' ');
      var imgSrc = item['img-src'];

      total += 1;
      $('#sub-product-list div.list-box ul.list').append(
        `<li data-size="` + item['category-size'] + `" data-rank="` + item['category-rank'] + `" data-cushion="` + item['category-cushion'] + `" data-spring="` + item['category-spring'] + `" data-store="` + item['category-store'] + `">
            <ul class="content">
              <li><a href="#"><img alt="" src="` + imgSrc + `" class="photo" /></a></li>
              <li>
                <ul class="info">
                  <li>
                    <p class="category-size">` + categorySize + `</p>
                  </li>
                  <li>
                    <p class="title">` + categoryName + `</p>
                  </li>
                  <li>
                    <p class="category-rank">` + categoryRank + `</p>
                  </li>
                  <img alt="찜하기" src="../img/icon-like.png" />
                </ul>
              </li>
            </ul>
        </li>`
      );
    });
    $('#sub-product-list .top > p.total-product > strong.num').text(total);

    // var listupTimer = setTimeout(function() {$('#sub-product-list div.list-box').css({'opacity': '1', 'transform': 'translateY(0)'});}, 500);
    $('#sub-product-list div.list-box').css({ 'opacity': '1', 'transform': 'translateY(0)' });
  }

  function setViewRow() {
    var windowHeight = $(window).width();
    if ($(window).height() < 768){
      $('#sub-product-list div.list-box').removeClass('row-1');
      $('#sub-product-list div.list-box').addClass('row-2');
      $('ul.arr-list > li').removeClass('on');
      $('div.top-m ul.arr-list > li:first-child').addClass('on');
    }else{
      $('#sub-product-list div.list-box').removeClass('row-2');
      $('#sub-product-list div.list-box').addClass('row-3');
      $('ul.arr-list > li').removeClass('on');
      $('div.top ul.arr-list > li:first-child').addClass('on');
    }
  }

  function setLogo() {
    var windowHeight = $(window).width();
    if(windowHeight < 768){
      $('#mobile-menu img.black').css({'display': 'none'});
      $('#mobile-menu img.white').css({'display': 'black'});
    } else {
      $('#mobile-menu img.black').css({'display': 'black'});
      $('#mobile-menu img.white').css({'display': 'none'});
    }
  }

  function addTag(id, text) {
  $('#sub-product-list .filter > ul.keyword > li').each(function (i) {
      if ($(this).attr('data-category') == id) {
        return false;
      }
    });
    $('#sub-product-list .filter').addClass('on');
    $('#sub-product-list .filter > ul.keyword').append('<li data-category="' + id + '"><span class="text">' + text + '</span><a class="del">삭제</a></li>\n');
  }
  function delTag(type, id) {
    if (type === 'all') {
      $('#sub-product-list .filter').removeClass('on');
      $('#sub-product-list .filter > ul.keyword > li').remove();
    } else {
      $('#sub-product-list .filter > ul.keyword > li').each(function (i) {
        if (id == $(this).attr('data-category')) {
          $(this).remove();
          return false;
        }
      });
    }
  }


  </script>
</html>